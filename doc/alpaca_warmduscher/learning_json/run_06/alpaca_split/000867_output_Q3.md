The `ntile(:maxRows) over (order by temperature_measure_date)` clause divides the rows retrieved from the `meteo_swiss` table into approximately `maxRows` equal-sized groups, based on the ascending order of the `temperature_measure_date`.  It assigns a group number (from 1 to `maxRows`) to each row.

This grouping is then used in the outer `group by` clause (`group by grp, station_id`). This effectively limits the number of rows that are aggregated together for each station.  Without the `ntile` clause, the query would aggregate all rows for each station within the specified date range, potentially resulting in a large number of aggregates. The `ntile` clause introduces a limit on the number of groups, thus controlling the granularity and size of the resulting statistics.  It distributes the data into buckets before grouping by station.