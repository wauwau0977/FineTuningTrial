For Project 'Warmduscher' considering file in path 'Warmduscher/thserver/src/main/java/com/x8ing/thsensor/thserver/db/dao/HeatPumpRepository.java' with name 'HeatPumpRepository.java'... 
The `getBoilerStatsByDayOfWeek` method contains a complex SQL query with multiple levels of nesting. What is the primary goal of using `To_Char(measurement_date, 'DAY')` and how does it affect the final result? Explain potential drawbacks of using this function directly in SQL for date-based analysis.