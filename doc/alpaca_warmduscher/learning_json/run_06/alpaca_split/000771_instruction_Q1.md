For Project 'Warmduscher' considering file in path 'Warmduscher/thserver/src/main/java/com/x8ing/thsensor/thserver/db/dao/HeatPumpRepository.java' with name 'HeatPumpRepository.java'... 
The `getBoilerStatsByHour` method utilizes a complex nested query. Explain the purpose of each subquery (h1 through h7) and how they contribute to the final result, focusing on the transformations applied to the data at each stage.